<!--<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Socket.io TESTE</title>
</head>
<body>
    <h1>TESTE</h1>
    <script src="https://cdn.socket.io/3.1.3/socket.io.min.js" integrity="sha384-cPwlPLvBTa3sKAgddT6krw0cJat7egBga3DJepJyrLl4Q9/5WLra3rrnMcyTyOnh" crossorigin="anonymous"></script>
    <script>
    const socket = io(window.location.origin);

socket.on('msg', (msg) => {
    alert(msg);
});
    </script>
</body>
</html>-->
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerador de QR Code Pix</title>
</head>
<body>
  <h1>Gerador de QR Code Pix</h1>
  
  <label for="amount">Valor do pagamento (em centavos):</label>
  <input type="number" id="amount" name="amount" required>
  
  <button id="generateButton">Gerar QR Code Pix</button>

  <div id="qrCode"></div>

  <!-- Adicione a biblioteca qrcode.js -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.4.4/qrcode.min.js" onload="init()"></script>
  <script>
    function init() {
      // Código para ser executado após a biblioteca qrcode.js ser carregada
      document.getElementById('generateButton').addEventListener('click', async () => {
        //const amount = document.getElementById('amount').value;
        const amount = '100'
        // Enviar o valor para o servidor
        const response = await fetch('/gerar-pix', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ amount: amount })
        });

        const data = await response.json();

        // Gerar e exibir o código QR Pix
        generatePixQrCode(data.pixKey, amount);
      });

      function generatePixQrCode(pixKey, amount) {
        const url = `https://pix.example.com/?chave=${pixKey}&amount=${amount}`;

        const qrCodeDiv = document.getElementById('qrCode');
        qrCodeDiv.innerHTML = ''; // Limpar o conteúdo anterior, se houver

        if (typeof QRCode !== 'undefined') {
          new QRCode(qrCodeDiv, {
            text: url,
            width: 256,
            height: 256
          });
        } else {
          console.error('Biblioteca QRCode não está disponível.');
        }
      }
    }
  </script>
</body>
</html>