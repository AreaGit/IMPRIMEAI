<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de QR Code PIX</title>
</head>
<body>
    <label for="valor">Valor:</label>
    <input type="number" id="valor" name="valor" placeholder="Digite o valor">
    <br>
    <label for="descricao">Descrição:</label>
    <input type="text" id="descricao" name="descricao" placeholder="Digite a descrição">
    <br>
    <button id="gerarQR">Gerar QR Code PIX</button>
    <br>
    <div id="qrCodeContainer"></div>
    <div id="pixPayloadContainer"></div>

    <script>
        document.getElementById('gerarQR').addEventListener('click', async () => {
            try {
                const valor = document.getElementById('valor').value;
                const descricao = document.getElementById('descricao').value;

                const response = await fetch('/gerarQRPix', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ valor, descricao })
                });

                if (!response.ok) {
                    throw new Error('Erro ao gerar QR Code PIX');
                }
                
                const { qrDataURL, pixPayload } = await response.json();

                // Exibir o QR Code na página
                const qrCodeImg = document.createElement('img');
                qrCodeImg.src = qrDataURL;
                document.getElementById('qrCodeContainer').innerHTML = '';
                document.getElementById('qrCodeContainer').appendChild(qrCodeImg);

                // Exibir o payload PIX na página
                const pixPayloadElement = document.createElement('p');
                pixPayloadElement.textContent = 'Payload PIX: ' + pixPayload;
                document.getElementById('pixPayloadContainer').innerHTML = '';
                document.getElementById('pixPayloadContainer').appendChild(pixPayloadElement);
            } catch (error) {
                console.error('Erro ao gerar QR Code PIX:', error);
               // alert('Erro ao gerar QR Code PIX. Por favor, tente novamente mais tarde.');
            }
        });
    </script>
</body>
</html>